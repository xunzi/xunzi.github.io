<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Einbruch! | Yaub (yet another useless blog)</title>
<meta name=keywords content="web,rootserver,security"><meta name=description content="Einbruch in unseren schönen Server! Spam- und Virusmails ham se verschickt, die Schmutzbuckel.
Aufgefallen ist das Ganze dadurch, daß Postfix immer versucht hat, Mails an den Webserver-User zuzustellen. Ich habe mir die Mails dann mal weiterleiten lassen und hatte in ein paar Sekunden weit über 500 neue Emails, alles Bounces von Aol und Yahoo, die mich darüber informieren wollten, daß meine Mails nicht zugestellt werden konnten. In der Mailqueue waren auch noch ein paar Dutzend Mails, denen die Mxe von Yahoo die Annahme verweigerten."><meta name=author content="Christian Drexler"><link rel=canonical href=https://drexler-online.net/post/einbruch/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://drexler-online.net/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://drexler-online.net/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://drexler-online.net/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://drexler-online.net/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://drexler-online.net/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Einbruch!"><meta property="og:description" content="Einbruch in unseren schönen Server! Spam- und Virusmails ham se verschickt, die Schmutzbuckel.
Aufgefallen ist das Ganze dadurch, daß Postfix immer versucht hat, Mails an den Webserver-User zuzustellen. Ich habe mir die Mails dann mal weiterleiten lassen und hatte in ein paar Sekunden weit über 500 neue Emails, alles Bounces von Aol und Yahoo, die mich darüber informieren wollten, daß meine Mails nicht zugestellt werden konnten. In der Mailqueue waren auch noch ein paar Dutzend Mails, denen die Mxe von Yahoo die Annahme verweigerten."><meta property="og:type" content="article"><meta property="og:url" content="https://drexler-online.net/post/einbruch/"><meta property="article:section" content="post"><meta property="article:published_time" content="2010-09-19T00:00:00+00:00"><meta property="article:modified_time" content="2021-12-26T22:21:01+01:00"><meta property="og:site_name" content="Yaub (yet another useless blog)"><meta name=twitter:card content="summary"><meta name=twitter:title content="Einbruch!"><meta name=twitter:description content="Einbruch in unseren schönen Server! Spam- und Virusmails ham se verschickt, die Schmutzbuckel.
Aufgefallen ist das Ganze dadurch, daß Postfix immer versucht hat, Mails an den Webserver-User zuzustellen. Ich habe mir die Mails dann mal weiterleiten lassen und hatte in ein paar Sekunden weit über 500 neue Emails, alles Bounces von Aol und Yahoo, die mich darüber informieren wollten, daß meine Mails nicht zugestellt werden konnten. In der Mailqueue waren auch noch ein paar Dutzend Mails, denen die Mxe von Yahoo die Annahme verweigerten."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Blog","item":"https://drexler-online.net/post/"},{"@type":"ListItem","position":3,"name":"Einbruch!","item":"https://drexler-online.net/post/einbruch/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Einbruch!","name":"Einbruch!","description":"Einbruch in unseren schönen Server! Spam- und Virusmails ham se verschickt, die Schmutzbuckel.\nAufgefallen ist das Ganze dadurch, daß Postfix immer versucht hat, Mails an den Webserver-User zuzustellen. Ich habe mir die Mails dann mal weiterleiten lassen und hatte in ein paar Sekunden weit über 500 neue Emails, alles Bounces von Aol und Yahoo, die mich darüber informieren wollten, daß meine Mails nicht zugestellt werden konnten. In der Mailqueue waren auch noch ein paar Dutzend Mails, denen die Mxe von Yahoo die Annahme verweigerten.","keywords":["web","rootserver","security"],"articleBody":"Einbruch in unseren schönen Server! Spam- und Virusmails ham se verschickt, die Schmutzbuckel.\nAufgefallen ist das Ganze dadurch, daß Postfix immer versucht hat, Mails an den Webserver-User zuzustellen. Ich habe mir die Mails dann mal weiterleiten lassen und hatte in ein paar Sekunden weit über 500 neue Emails, alles Bounces von Aol und Yahoo, die mich darüber informieren wollten, daß meine Mails nicht zugestellt werden konnten. In der Mailqueue waren auch noch ein paar Dutzend Mails, denen die Mxe von Yahoo die Annahme verweigerten. Sehr verdächtig! Die gebouncten Mails machten Werbung für potenzsteigernde Mittel und enthielten wohl auch Viren.\nDer Einbruch erfolgte über eine nicht gepatchte Webapplikation, hier fanden sich dann in einem Cache-Verzeichnis ein paar Php-Dateien, namens admin.php, cache.php (die sind nach dem Dateidatum zusammen dort gelandet), cached.php (zwei Tage später hochgeladen) und sendme.php (hierüber sind die Spammails hochgeladen worden). Admin.php ist ein Webinterface, mit dem man verschiedene interessante Sachen machen kann. Cache.php und cached.php ermöglichen es, einen Irc-Server aufzumachen.\nDie Zahl der Müllmails liegt bei etwa 20000, das hat schon gereicht, um auf die Blackliste von Barracuda zu kommen (die haben den Eintrag aber auf Nachfrage sehr schnell wieder gelöscht).\nInsgesamt eine sehr ärgerliche Geschichte, die wohl auch noch unangenehmer hätte ausgehen können.\nDie Datei admin.php hat die Checksumme 20ed027c0d6d6798b3ec03fb8ef42756, falls mal einer vergleichen will.\nAls Gegenmaßnahme habe ich dem Webserver-User die Shell gegen /bin/false ausgetauscht (das hätte ich schon längst machen sollen) und einen Bcc für alle Mails eingerichtet, die der Webserver-User schickt. Das geht mit folgendem Eintrag in /etc/postfix/main.cf:\nsender_bcc_maps = hash:/etc/postfix/sender_bcc\nIn dieser Datei stehen Absenderadressen und die dazugehörigen bcc-Adressen. Das Ganze muß noch per postmap /etc/postfix/sender_bcc in eine Hashmap umgewandelt werden, dann wird für jede Mail, die www-data@minden144.server4you.de eine Blindkopie an eine andere Andresse geschickt.\n","wordCount":"291","inLanguage":"en","datePublished":"2010-09-19T00:00:00Z","dateModified":"2021-12-26T22:21:01+01:00","author":{"@type":"Person","name":"Christian Drexler"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://drexler-online.net/post/einbruch/"},"publisher":{"@type":"Organization","name":"Yaub (yet another useless blog)","logo":{"@type":"ImageObject","url":"https://drexler-online.net/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://drexler-online.net accesskey=h title="Home (Alt + H)"><img src=https://drexler-online.net/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://drexler-online.net/about title=about><span>about</span></a></li><li><a href=https://drexler-online.net/tags/ title=tags><span>tags</span></a></li><li><a href=https://social.konsolenknecht.de/users/cd title="activity pub"><span>activity pub</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://github.com/xunzi title=github><span>github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://drexler-online.net>Home</a>&nbsp;»&nbsp;<a href=https://drexler-online.net/post/>Blog</a></div><h1 class=post-title>Einbruch!</h1><div class=post-meta><span title='2010-09-19 00:00:00 +0000 UTC'>September 19, 2010</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;291 words&nbsp;·&nbsp;Christian Drexler</div></header><div class=post-content><p>Einbruch in unseren schönen Server! Spam- und Virusmails ham se
verschickt, die Schmutzbuckel.</p><p>Aufgefallen ist das Ganze dadurch, daß Postfix immer versucht hat, Mails
an den Webserver-User zuzustellen. Ich habe mir die Mails dann mal
weiterleiten lassen und hatte in ein paar Sekunden weit über 500 neue
Emails, alles Bounces von Aol und Yahoo, die mich darüber informieren
wollten, daß meine Mails nicht zugestellt werden konnten. In der
Mailqueue waren auch noch ein paar Dutzend Mails, denen die Mxe von
Yahoo die Annahme verweigerten. Sehr verdächtig! Die gebouncten Mails
machten Werbung für potenzsteigernde Mittel und enthielten wohl auch
Viren.</p><p>Der Einbruch erfolgte über eine nicht gepatchte Webapplikation, hier
fanden sich dann in einem Cache-Verzeichnis ein paar Php-Dateien, namens
admin.php, cache.php (die sind nach dem Dateidatum zusammen dort
gelandet), cached.php (zwei Tage später hochgeladen) und sendme.php
(hierüber sind die Spammails hochgeladen worden). Admin.php ist ein
<a href=/static/w4ck1ng.png>Webinterface</a>, mit dem man verschiedene interessante Sachen machen
kann. Cache.php und cached.php ermöglichen es, einen Irc-Server
aufzumachen.</p><p>Die Zahl der Müllmails liegt bei etwa 20000, das hat schon gereicht, um
auf die Blackliste von Barracuda zu kommen (die haben den Eintrag aber
auf Nachfrage sehr schnell wieder gelöscht).</p><p>Insgesamt eine sehr ärgerliche Geschichte, die wohl auch noch
unangenehmer hätte ausgehen können.</p><p>Die Datei admin.php hat die Checksumme 20ed027c0d6d6798b3ec03fb8ef42756,
falls mal einer vergleichen will.</p><p>Als Gegenmaßnahme habe ich dem Webserver-User die Shell gegen /bin/false
ausgetauscht (das hätte ich schon längst machen sollen) und einen Bcc
für alle Mails eingerichtet, die der Webserver-User schickt. Das geht
mit folgendem Eintrag in /etc/postfix/main.cf:</p><p><code>sender_bcc_maps = hash:/etc/postfix/sender_bcc</code></p><p>In dieser Datei stehen Absenderadressen und die dazugehörigen
bcc-Adressen. Das Ganze muß noch per postmap /etc/postfix/sender_bcc in
eine Hashmap umgewandelt werden, dann wird für jede Mail, die
<a href=mailto:www-data@minden144.server4you.de>www-data@minden144.server4you.de</a> eine Blindkopie an eine andere Andresse
geschickt.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://drexler-online.net/tags/web/>web</a></li><li><a href=https://drexler-online.net/tags/rootserver/>rootserver</a></li><li><a href=https://drexler-online.net/tags/security/>security</a></li></ul><nav class=paginav><a class=prev href=https://drexler-online.net/post/org-mode/><span class=title>« Prev</span><br><span>Org-mode</span>
</a><a class=next href=https://drexler-online.net/post/von-linux-zu-macos/><span class=title>Next »</span><br><span>von Linux zu MacOS</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://drexler-online.net>Yaub (yet another useless blog)</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>